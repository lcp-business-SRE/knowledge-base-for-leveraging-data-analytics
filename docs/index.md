# Windows上のVSCodeでJekyllとGitHub Pagesを使って静的サイトを構築する包括的ガイド

## Jekyllとは？静的サイトジェネレーターの利点

Jekyllは、MarkdownやHTMLファイル、およびLiquidテンプレート言語を用いて静的なウェブサイトを生成する、Rubyベースのプログラムです 。これは、動的なコンテンツをサーバーサイドで生成する従来のCMS（コンテンツ管理システム）とは異なり、事前に完全なHTML、CSS、JavaScriptファイルを生成します。この特性により、Jekyllはサイトの見た目、URL構造、ページに表示されるデータなどを柔軟に調整できる強力なツールとなっています 。   

静的サイトの利用には、いくつかの顕著な利点があります。まず、サーバーサイドでの処理が不要なため、ウェブサイトの読み込み速度が大幅に向上します。これはユーザーエクスペリエンスの向上だけでなく、検索エンジン最適化（SEO）にも寄与します。次に、データベースやサーバーサイドのスクリプトが存在しないため、セキュリティ上の脆弱性が大幅に低減されます。これにより、サイトの維持管理が簡素化され、潜在的な攻撃対象が減少します。さらに、静的ファイルは通常のウェブサーバーで容易にホスティングできるため、ホスティングコストを抑えることが可能です。最後に、JekyllサイトのソースファイルはGitのようなバージョン管理システムと非常に親和性が高く、変更履歴の追跡、共同作業、デプロイメントの自動化が容易になります 。   

## GitHub Pagesとは？Jekyllとの連携の概要

GitHub Pagesは、GitHubが提供する無料のウェブホスティングサービスであり、ユーザー、組織、またはリポジトリに紐づく公開ウェブページをgithub.ioドメイン、またはカスタムドメインでホストすることを可能にします 。このサービスは、そのバックエンドでJekyllによって動作しており、GitHubリポジトリにJekyllのソースファイルをプッシュするだけで、サイトが自動的にビルドされて公開されるという大きな利便性を提供します 。   

GitHubリポジトリでGitHub Actionsが有効になっている場合、GitHub Pagesは組み込みのJekyllワークフローを利用してサイトをビルドします 。しかし、Jekyllのビルドプロセスをバイパスし、単に静的HTMLコンテンツを直接デプロイしたい場合もあります。このようなシナリオでは、ソースブランチのルートに.nojekyllという空のファイルを追加することで、Jekyllによる処理をスキップし、リポジトリ内のファイルをそのままウェブサイトとして公開できます 。

JekyllとGitHub Pagesの連携は非常に強力ですが、いくつかの考慮事項があります。JekyllはRubyベースのプログラムであり、その実行にはRuby環境が必要です 。特にWindows環境では、Rubyのインストールプロセスにおいて、パスの設定、開発ツールキット（DevKit）の不足、SSL証明書の問題など、特有の複雑な課題に直面することが少なくありません 。これらの初期設定における潜在的な問題は、Jekyll開発を開始する上での大きな障壁となり得ます。このため、環境構築の段階でこれらの課題を適切に解決するための詳細な手順とトラブルシューティングが不可欠です。

また、GitHub PagesのJekyllサポートにはプラグインに関する重要な制約が存在します。GitHub Pagesは、デフォルトで有効化されている一部のJekyllプラグインのみをサポートしており、それ以外のカスタムプラグインやサポートされていないプラグインを使用すると、GitHub Pages上でのサイトの自動ビルドが失敗します 。この制限は、開発者がJekyllの高度な機能や特定のジェムを利用したい場合に、GitHub Pagesの自動ビルド機能にそのまま依存できないことを意味します。このような場合、開発者はサイトをローカルでビルドし、生成された静的ファイル（通常は_siteディレクトリの内容）をGitHubリポジトリにプッシュするか、あるいはGitHub Actionsを利用してカスタムのビルドおよびデプロイワークフローを構築するという、より複雑なデプロイ戦略を選択する必要があります 。このトレードオフは、開発ワークフローの複雑性やCI/CDパイプラインの設計に直接的な影響を与えるため、プロジェクトの要件に応じて適切なデプロイ方法を選択することが重要になります。   

## ステップ1: Windows開発環境の準備

JekyllサイトをWindows環境のVSCodeで開発し、GitHub Pagesにデプロイするためには、いくつかの重要なツールと環境設定が必要です。特にJekyllがRubyベースであるため、WindowsにおけるRuby環境の準備が成功の鍵を握ります。

### Rubyのインストール（RubyInstaller + DevKit推奨）

JekyllはRubyで動作するため、まずWindows環境にRubyをインストールする必要があります 。公式には、Windowsユーザー向けにRubyInstallerが推奨されるインストール方法です 。   

RubyInstallerのウェブサイトにアクセスし、Jekyllの要件を満たす最新の安定版（例: Ruby+Devkit 3.2.2.1 x64、またはJekyllが要求するRuby version 2.7.0以上）をダウンロードすることが推奨されます 。インストーラーの指示に従い、通常はデフォルト設定でインストールを進めます。インストール完了後、コマンドプロンプトにDevKitのセットアッププロンプトが表示される場合があります。この際、通常はプロンプトが表示されたらEnterを2回押してデフォルトオプションを選択することで、Jekyllのネイティブ拡張機能のビルドに必要なツールがインストールされます 。   

RubyInstallerは通常、Ruby実行ファイルへのパスをシステム環境変数PATHに自動的に追加しますが、インストール後に新しいコマンドプロンプトを開き、ruby -vと入力してRubyのバージョンが表示されることを確認することが重要です 。もしバージョン情報が表示されない場合は、Rubyのインストールディレクトリ内のbinフォルダ（例: C:\Ruby26-x64\bin）をPATHに手動で追加する必要があります 。   

RubyInstallerでDevKitをインストールした場合でも、手動で初期化とRubyインストールへのバインドが必要となることがあります。DevKitを解凍したディレクトリ（例: C:\RubyDevKit）に移動し、以下のコマンドを順番に実行することで、DevKitがRuby環境に適切に紐付けられます 

``` Bash
ruby dk.rb init
ruby dk.rb install
```

Windows環境でのRubyインストールには、RubyInstaller以外にもいくつかの代替方法が存在します。WindowsのパッケージマネージャーであるChocolateyを事前にインストールしておくと、choco install ruby --version=[希望バージョン]のようにコマンドを実行するだけでRubyのインストールが容易になります 。ChocolateyはRubyのバージョン管理を簡素化する利点があります。また、Windows 10以降のユーザーは、Windows Subsystem for Linux (WSL) を有効にし、その上でLinux版のRubyとJekyllをインストールすることも可能です 。WSLはJekyllのネイティブ環境であるLinuxに近い環境を提供するため、Windows特有の依存関係の問題を回避できる可能性があります。これらの選択肢は、ユーザーの技術習熟度や、将来的に他のRubyプロジェクトを扱う可能性に応じて、最適なインストール方法が異なることを示唆しています。RubyInstallerは最も直接的なアプローチですが、Windows特有のパスの問題やSSL証明書の問題に遭遇する可能性が高いため、これらの代替案も考慮に入れることで、より安定した開発環境を構築できる場合があります。   

特にWindows環境では、Rubyのインストールパスにスペースが含まれる（例: C:\Program Files）と、JekyllやBundlerのインストール時にビルドエラーが発生することがあります 。この問題は、Rubyのネイティブ拡張機能のビルドプロセスが、パス内のスペースを正しく処理できないことに起因します。そのため、Rubyをインストールする際は、C:\Ruby26-x64のようにスペースを含まない短いパスを選択することが強く推奨されます。また、RubyGemsからのGemダウンロード時に「SSL証明書検証の失敗」エラー（例: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed）が発生することがあります。これは、Rubyが使用するOpenSSLライブラリがSSL証明書を正しく検証できないことに起因する、Windowsにおける長年の問題です。この問題は、cacert.pemファイルをダウンロードし、そのパスをSSL_CERT_FILE環境変数に設定することで解決できます 。これらのWindows特有の環境設定は、Jekyllの動作に直接的な影響を与えるため、単なるトラブルシューティングとしてではなく、環境準備の必須ステップとして理解し、事前に対応することが、スムーズなJekyll開発の開始に繋がります。   


## 3. ステップ2: JekyllとBundlerのセットアップ

RubyとGitの環境が整ったら、Jekyll本体と、その依存関係を管理するためのBundlerをセットアップします。

### Jekyll Gemのインストール

Rubyのインストールが完了し、コマンドプロンプトでruby -vが正しく動作することを確認した後、JekyllをRubyGems（Rubyのパッケージ管理システム）経由でシステムにインストールします。新しいコマンドプロンプトを開き、以下のコマンドを実行します。

``` bash
gem install jekyll
```

インストールが成功したことを確認するには、jekyll -vと入力し、Jekyllのバージョン番号が表示されることを確認してください 。これにより、Jekyllの実行ファイルがシステムPATHに適切に追加され、どこからでもコマンドが実行できる状態になります。

### Bundler Gemのインストール

Bundlerは、Jekyllプロジェクトの依存関係（Gem）を管理するための不可欠なツールです 。Bundlerを使用することで、プロジェクトが使用する特定のGemのバージョンが固定され、開発者のローカルマシン、CI/CDパイプライン、GitHub Pagesのビルド環境など、異なる環境間でJekyllサイトの一貫した動作が保証されます。これは、開発者が「自分のマシンでは動くのに、デプロイ環境では動かない」といった、依存関係の競合やバージョン不一致に起因するデプロイ時の予期せぬエラーを最小限に抑える上で極めて重要です。

以下のコマンドでBundlerをインストールします。

``` bash
gem install bundler
```

インストールが完了したら、bundler -vと入力して、Bundlerのバージョンが表示されることを確認します。これにより、Bundlerが正しくインストールされ、Jekyllプロジェクトの依存関係を管理できる状態になります。

### プロジェクトの初期化と依存関係の管理

Jekyllサイトのルートディレクトリに移動します 。

- 新しいJekyllサイトを作成する場合: jekyll new [サイト名]コマンドでサイトを作成すると、Jekyllは自動的に基本的なGemfileを作成します 。このGemfileには、Jekyllとそのデフォルトテーマに必要なGemが記述されています。   
- 既存のテーマをダウンロードした場合: ダウンロードしたテーマのディレクトリに移動し、もし既存のGemfileやGemfile.lockファイルがある場合は、それらを削除してから以下のコマンドを実行して新しいGemfileを作成します 。

``` bash
bundle init
```

次に、プロジェクトのすべての依存関係（Gemfileに記述されたGem）をインストールします。これにより、Jekyllとその関連Gemがプロジェクト固有の環境にインストールされ、前述の一貫性が確保されます。

``` bash
bundle install
```

GitHub Pagesでサイトをホストする場合、Gemfileにgem "github-pages"を追加することが強く推奨されます 。このGemは、GitHub PagesがサポートするJekyllのバージョンと、それに含まれるプラグインのセットをローカル環境に提供するため、ローカルでの開発とGitHub Pages上でのビルドの互換性を高めます。これにより、GitHub Pagesのビルド環境で発生しうる予期せぬエラーを減らし、デプロイメントの信頼性を向上させることが期待されます。   

## 4. ステップ3: 新しいJekyllサイトの作成とローカルでのプレビュー

JekyllとBundlerのセットアップが完了したら、実際にJekyllサイトを作成し、ローカル環境でその動作を確認します。

### Jekyllサイトの生成

サイトを作成したい任意のディレクトリに移動し、以下のコマンドで新しいJekyllサイトを生成します。このコマンドは、デフォルトのテーマと基本的なファイル構造（_posts、_layouts、_includes、_config.ymlなど）を自動的に作成します 。   

``` bash
jekyll new [サイト名]
# 例: jekyll new my-awesome-site
```

もし、テーマやコンテンツを含まない、まっさらなサイト構造（スケルトン）から始めたい場合は、--blankオプションを使用します 。サイトが作成されたら、その新しいディレクトリに移動します。

``` bash
cd [サイト名]
# 例: cd my-awesome-site
```

### サイト構造の理解

Jekyllサイトは、MarkdownやHTMLで書かれたコンテンツファイルと、それらを最終的な静的Webページにレンダリングするためのレイアウトファイルで構成されます 。主要なディレクトリとその役割は以下の通りです。

- `_posts/`: ブログの投稿記事を格納するディレクトリです。ファイル名はYYYY-MM-DD-title.mdの形式に従います。
- `_pages/`: 静的なページ（例: 「About」ページや「Contact」ページ）を格納します。
- `_layouts/`: サイトの各ページや投稿の構造を定義するテンプレートファイル（HTML）が置かれます 。
- `_includes/`: 複数のレイアウトやページで再利用される小さなHTMLスニペット（例: ヘッダー、フッター、ナビゲーションバー）を格納します 。
- `_sass/`: Sass/SCSSファイルが置かれ、CSSのプリプロセッシングに使用されます。
- `assets/`: 画像、CSS、JavaScriptなどの静的アセットが通常ここに配置されます.   
- `_config.yml`: サイト全体のタイトル、説明、テーマ、URL設定など、Jekyllのグローバル設定を定義するYAMLファイルです 。

### サイトのローカルプレビュー

Jekyllサイトのコンテンツやデザインを変更するたびに、その変更がどのように表示されるかを確認するために、ローカルサーバーでプレビューすることが可能です。これにより、変更をGitHubにプッシュする前に、意図した通りに表示されるかを検証できます 。   

サイトのルートディレクトリにいることを確認し、以下のコマンドを実行します。

``` bash
bundle exec jekyll serve
```

このコマンドはJekyllサイトをビルドし、デフォルトで`http://localhost:4000`で利用可能なローカルWebサーバーを起動します 。ブラウザでこのURLにアクセスすると、現在開発中のサイトが表示されます。

開発中にソースファイルを変更するたびに自動的にページをリロードさせたい場合は、--livereloadオプションを追加します。

``` bash
bundle exec jekyll serve --livereload
```

これにより、コードの変更が即座にブラウザに反映され、開発効率が大幅に向上します。なお、Rubyバージョン3.0.0以降を使用している場合、jekyll serveコマンドの実行時にwebrickが見つからないというエラーが発生することがあります。この場合、bundle add webrickを実行してwebrick Gemを依存関係に追加することで解決できます 。

## VSCodeでの開発環境の最適化

Visual Studio Code (VSCode) は、Jekyllサイト開発のための強力なIDEであり、多くの拡張機能が開発ワークフローを効率化します。

### Jekyll Run拡張機能

このVSCode拡張機能は、Jekyllサイトのビルド、ローカルサーバーの起動、停止、再起動、そしてブラウザでのサイトの開閉をVSCode内から直接行うための便利なコマンドとショートカットを提供します 。例えば、Ctrl+F5でサイトをビルドしてサーバーを起動し、ブラウザで開くことができます。また、jekyll-run.commandLineArguments設定を通じて、bundle exec jekyll serveコマンドにカスタム引数を渡すことも可能です 。

### Liquid Language Support拡張機能

JekyllはLiquidテンプレート言語を使用するため、この拡張機能はLiquidファイルのシンタックスハイライト、オートコンプリート、フォーマット、および検証機能を提供し、Liquidコードの記述を大幅に支援します 。HTML、Markdown、YAML、CSS、JavaScriptファイル内に埋め込まれたLiquid構文もサポートされており、Jekyllプロジェクト全体のコード品質と開発速度を向上させます 。ただし、MarkdownやYAMLファイル内でLiquid構文を使用する場合、VSCodeが「無効なコード」と報告することがあるため、必要に応じて検証機能を無効にすることを検討してください 。   

## ステップ4: GitHubリポジトリのセットアップとJekyllサイトのデプロイ

Jekyllサイトがローカルで正しく動作することを確認したら、次にGitHub Pagesにデプロイするためのリポジトリを設定し、サイトを公開します。

### GitHubリポジトリの作成と初期設定

GitHub Pagesでサイトをホストするには、まずGitHub.com上に新しいリポジトリを作成する必要があります 。GitHub Pagesには主に2つのタイプがあります。   

- ユーザー/組織ページ (User/Organization Pages)
  - 個人のユーザーアカウントまたは組織アカウントに紐づくウェブサイトです。リポジトリ名は<username>.github.ioまたは<organization>.github.ioの形式にする必要があります 。これらのサイトは通常、リポジトリのmainブランチの内容から公開されます 。   
- プロジェクトページ (Project Pages)
  - 特定のプロジェクトに紐づくウェブサイトです。リポジトリ名はプロジェクト名で構いません。サイトは<username>.github.io/<repo-name>のようなサブパスで公開されます 。   

リポジトリ作成時には「Initialize this repository with a README」チェックボックスを選択し、READMEファイルで初期化することが推奨されます 。

### ブランチ戦略と公開ソースの設定

プロジェクトページの場合、ウェブサイトのコンテンツは通常、gh-pagesという名前の専用ブランチ、またはmainブランチ内のdocsフォルダに格納されます 。ユーザー/組織ページの場合は、mainブランチが直接公開ソースとなります 。   

リポジトリ作成後、GitHubのSettings > Pagesセクションで、サイトの公開ソース（Publishing Source）を設定します 。ここで、サイトのソースファイルが存在するブランチとフォルダ（例: gh-pagesブランチのルート、またはmainブランチの/docsフォルダ）を選択します。この設定により、選択されたソースブランチにプッシュされた変更が自動的にGitHub Pagesによってビルドされ、公開されます 。 

### ローカルリポジトリとGitHubの同期

GitHubリポジトリを作成したら、ローカルマシンにクローンします。

